(* Copyright (c) 2014-2017 David Kaloper MerÅ¡injak. All rights reserved.
   See LICENSE.md. *)

open Asn
open Asn.S

type tBSCertificate = {
  version    : [ `V1 | `V2 | `V3 ] ;
  serial     : Z.t ;
  signature  : OID.t ;
  issuer     : (OID.t * string) list list ;
  validity   : Ptime.t * Ptime.t ;
  subject    : (OID.t * string) list list ;
  pk_info    : OID.t * Cstruct.t ;
  issuer_id  : Cstruct.t option ;
  subject_id : Cstruct.t option ;
  extensions : (OID.t * bool * Cstruct.t) list option
}

type certificate = {
  tbs_cert       : tBSCertificate ;
  signature_algo : OID.t ;
  signature      : Cstruct.t
}

let def  x = function None -> x | Some y -> y

let def' x = fun y -> if y = x then None else Some y

let extensions =
  let extension =
    map (fun (oid, b, v) -> (oid, def  false b, v))
        (fun (oid, b, v) -> (oid, def' false b, v)) @@
    sequence3
      (required ~label:"id"       oid)
      (optional ~label:"critical" bool) (* default false *)
      (required ~label:"value"    octet_string)
  in
  sequence_of extension

let directory_name =
  map (function | `C1 s -> s | `C2 s -> s | `C3 s -> s
                | `C4 s -> s | `C5 s -> s | `C6 s -> s)
      (function s -> `C1 s)
  @@
  choice6
    printable_string utf8_string
    (* The following three could probably be ommited.
      * See rfc5280 section 4.1.2.4. *)
    teletex_string universal_string bmp_string
    (* is this standard? *)
    ia5_string

let name =
  let attribute_tv =
   sequence2
      (required ~label:"attr type"  oid)
      (* This is ANY according to rfc5280. *)
      (required ~label:"attr value" directory_name) in
  let rd_name      = set_of attribute_tv in
  let rdn_sequence = sequence_of rd_name in
  rdn_sequence (* A vacuous choice, in the standard. *)

let algorithmIdentifier =
  map (fun (oid, _) -> oid) (fun oid -> (oid, None))
  @@
  sequence2
    (required ~label:"algorithm" oid)
    (* This is ANY according to rfc5280 *)
    (optional ~label:"params"    null)

let version =
  map (function 2 -> `V2 | 3 -> `V3 | _ -> `V1)
      (function `V2 -> 2 | `V3 -> 3 | _ -> 1)
  int

let certificateSerialNumber = integer

let time =
  map (function `C1 t -> t | `C2 t -> t) (fun t -> `C2 t)
      (choice2 utc_time generalized_time)

let validity =
  sequence2
    (required ~label:"not before" time)
    (required ~label:"not after"  time)

let subjectPublicKeyInfo =
  sequence2
    (required ~label:"algorithm" algorithmIdentifier)
    (required ~label:"subjectPK" bit_string_cs)

let uniqueIdentifier = bit_string_cs

let tBSCertificate =
  let f = fun (a, (b, (c, (d, (e, (f, (g, (h, (i, j))))))))) ->
    { version    = def `V1 a ; serial     = b ;
      signature  = c         ; issuer     = d ;
      validity   = e         ; subject    = f ;
      pk_info    = g         ; issuer_id  = h ;
      subject_id = i         ; extensions = j }

  and g = fun
    { version    = a ; serial     = b ;
      signature  = c ; issuer     = d ;
      validity   = e ; subject    = f ;
      pk_info    = g ; issuer_id  = h ;
      subject_id = i ; extensions = j } ->
    (def' `V1 a, (b, (c, (d, (e, (f, (g, (h, (i, j)))))))))
  in

  map f g @@
  sequence @@
      (optional ~label:"version"       @@ explicit 0 version) (* default v1 *)
    @ (required ~label:"serialNumber"  @@ certificateSerialNumber)
    @ (required ~label:"signature"     @@ algorithmIdentifier)
    @ (required ~label:"issuer"        @@ name)
    @ (required ~label:"validity"      @@ validity)
    @ (required ~label:"subject"       @@ name)
    @ (required ~label:"subjectPKInfo" @@ subjectPublicKeyInfo)
      (* if present, version is v2 or v3 *)
    @ (optional ~label:"issuerUID"     @@ implicit 1 uniqueIdentifier)
      (* if present, version is v2 or v3 *)
    @ (optional ~label:"subjectUID"    @@ implicit 2 uniqueIdentifier)
      (* v3 if present *)
   -@ (optional ~label:"extensions"    @@ explicit 3 extensions)

let certificate =

  let f (a, b, c) =
    { tbs_cert = a ; signature_algo = b ; signature = c }

  and g { tbs_cert = a ; signature_algo = b ; signature = c } =
    (a, b, c) in

  map f g @@
  sequence3
    (required ~label:"tbsCertificate"     tBSCertificate)
    (required ~label:"signatureAlgorithm" algorithmIdentifier)
    (required ~label:"signatureValue"     bit_string_cs)

let cert_ber, cert_der =
  (codec ber certificate, codec der certificate)


let examples = [
  [ 0x30; 0x82; 0x06; 0x20; 0x30; 0x82; 0x04; 0x08; 0xA0; 0x03; 0x02; 0x01; 0x02;
    0x02; 0x03; 0x02; 0x0A; 0xCD; 0x30; 0x0D; 0x06; 0x09; 0x2A; 0x86; 0x48; 0x86;
    0xF7; 0x0D; 0x01; 0x01; 0x05; 0x05; 0x00; 0x30; 0x54; 0x31; 0x14; 0x30; 0x12;
    0x06; 0x03; 0x55; 0x04; 0x0A; 0x13; 0x0B; 0x43; 0x41; 0x63; 0x65; 0x72; 0x74;
    0x20; 0x49; 0x6E; 0x63; 0x2E; 0x31; 0x1E; 0x30; 0x1C; 0x06; 0x03; 0x55; 0x04;
    0x0B; 0x13; 0x15; 0x68; 0x74; 0x74; 0x70; 0x3A; 0x2F; 0x2F; 0x77; 0x77; 0x77;
    0x2E; 0x43; 0x41; 0x63; 0x65; 0x72; 0x74; 0x2E; 0x6F; 0x72; 0x67; 0x31; 0x1C;
    0x30; 0x1A; 0x06; 0x03; 0x55; 0x04; 0x03; 0x13; 0x13; 0x43; 0x41; 0x63; 0x65;
    0x72; 0x74; 0x20; 0x43; 0x6C; 0x61; 0x73; 0x73; 0x20; 0x33; 0x20; 0x52; 0x6F;
    0x6F; 0x74; 0x30; 0x1E; 0x17; 0x0D; 0x31; 0x33; 0x30; 0x39; 0x30; 0x34; 0x31;
    0x35; 0x34; 0x33; 0x33; 0x39; 0x5A; 0x17; 0x0D; 0x31; 0x35; 0x30; 0x39; 0x30;
    0x34; 0x31; 0x35; 0x34; 0x33; 0x33; 0x39; 0x5A; 0x30; 0x69; 0x31; 0x0B; 0x30;
    0x09; 0x06; 0x03; 0x55; 0x04; 0x06; 0x13; 0x02; 0x44; 0x45; 0x31; 0x10; 0x30;
    0x0E; 0x06; 0x03; 0x55; 0x04; 0x08; 0x13; 0x07; 0x48; 0x61; 0x6D; 0x62; 0x75;
    0x72; 0x67; 0x31; 0x10; 0x30; 0x0E; 0x06; 0x03; 0x55; 0x04; 0x07; 0x13; 0x07;
    0x48; 0x61; 0x6D; 0x62; 0x75; 0x72; 0x67; 0x31; 0x21; 0x30; 0x1F; 0x06; 0x03;
    0x55; 0x04; 0x0A; 0x13; 0x18; 0x43; 0x68; 0x61; 0x6F; 0x73; 0x20; 0x43; 0x6F;
    0x6D; 0x70; 0x75; 0x74; 0x65; 0x72; 0x20; 0x43; 0x6C; 0x75; 0x62; 0x20; 0x65;
    0x2E; 0x56; 0x2E; 0x31; 0x13; 0x30; 0x11; 0x06; 0x03; 0x55; 0x04; 0x03; 0x13;
    0x0A; 0x77; 0x77; 0x77; 0x2E; 0x63; 0x63; 0x63; 0x2E; 0x64; 0x65; 0x30; 0x82;
    0x02; 0x22; 0x30; 0x0D; 0x06; 0x09; 0x2A; 0x86; 0x48; 0x86; 0xF7; 0x0D; 0x01;
    0x01; 0x01; 0x05; 0x00; 0x03; 0x82; 0x02; 0x0F; 0x00; 0x30; 0x82; 0x02; 0x0A;
    0x02; 0x82; 0x02; 0x01; 0x00; 0xB8; 0x67; 0x42; 0x2B; 0x9B; 0xEC; 0x45; 0x48;
    0x86; 0x39; 0xB5; 0xE8; 0x6D; 0x7B; 0x88; 0x48; 0xBE; 0xEC; 0x01; 0x73; 0x28;
    0x59; 0xF6; 0xE9; 0x6A; 0x2E; 0x63; 0x84; 0x62; 0x37; 0x16; 0x9F; 0xA9; 0x33;
    0x61; 0xA5; 0x29; 0x4B; 0xB9; 0xBF; 0xFB; 0x93; 0x6F; 0x64; 0x19; 0x5B; 0xA0;
    0xC7; 0x5A; 0x81; 0xD6; 0xD9; 0x00; 0x20; 0x7C; 0x44; 0x7B; 0xAA; 0x46; 0x6D;
    0xB5; 0xAA; 0x2D; 0xDB; 0x75; 0x82; 0x07; 0x38; 0x8B; 0x1F; 0x74; 0x49; 0x9E;
    0xC0; 0x70; 0xBB; 0xC0; 0x9B; 0x50; 0x76; 0xC2; 0xC8; 0xD7; 0x29; 0x63; 0x62;
    0x04; 0x16; 0xD7; 0xE6; 0xAA; 0x47; 0xAB; 0xAC; 0x84; 0xAE; 0xE2; 0x6B; 0x17;
    0x59; 0x68; 0x53; 0xA9; 0x0C; 0xB2; 0x7C; 0x5A; 0x57; 0xF0; 0x66; 0xF6; 0xED;
    0x3B; 0x29; 0xD8; 0x78; 0xE9; 0xA1; 0xE7; 0xE3; 0x19; 0x9D; 0x95; 0x3F; 0xE0;
    0xBD; 0x36; 0x4B; 0x24; 0xAF; 0x59; 0xE9; 0xFF; 0x87; 0xC4; 0xDE; 0xD1; 0xF3;
    0x65; 0x98; 0x74; 0x76; 0x80; 0xD9; 0x5C; 0xCF; 0xB5; 0x20; 0x90; 0xE7; 0xCF;
    0x51; 0x7C; 0xF4; 0x50; 0xED; 0xD8; 0x36; 0x42; 0x59; 0x83; 0x70; 0x19; 0xBC;
    0xC3; 0x36; 0xEA; 0xAF; 0xEB; 0xB4; 0xF5; 0xFE; 0xD7; 0x70; 0x98; 0x1C; 0x05;
    0x88; 0xFA; 0x44; 0xDE; 0x4D; 0x42; 0x5F; 0x78; 0xBC; 0x12; 0xBC; 0xFA; 0xB8;
    0xCA; 0xDE; 0x0A; 0x8A; 0x2D; 0x09; 0xD8; 0x34; 0x01; 0x49; 0x0D; 0xC1; 0x43;
    0xBD; 0x81; 0x3C; 0x60; 0x54; 0xC5; 0xB0; 0x09; 0xE9; 0x8D; 0x38; 0x25; 0x44;
    0xF9; 0x48; 0xA9; 0xFE; 0x77; 0x40; 0x3E; 0x13; 0x42; 0x74; 0xCE; 0xA8; 0xBA;
    0x85; 0x1E; 0x50; 0x37; 0xB0; 0x0A; 0x3A; 0x07; 0x52; 0x26; 0x67; 0x6A; 0xEA;
    0xAC; 0xC9; 0x06; 0x4E; 0x59; 0x87; 0xC1; 0xB9; 0x65; 0x34; 0xAF; 0x2E; 0x91;
    0x96; 0x44; 0x24; 0x62; 0xA4; 0x0A; 0x02; 0xB6; 0x6A; 0xAB; 0xE2; 0x2A; 0x9D;
    0xB1; 0xB6; 0xAF; 0x1B; 0xAB; 0xEC; 0x2C; 0x55; 0x56; 0xFC; 0x53; 0x72; 0x5E;
    0x16; 0x59; 0xF4; 0xA8; 0x10; 0xA7; 0xA4; 0xB1; 0xB2; 0xDE; 0xCA; 0x5B; 0xEF;
    0x1C; 0xD9; 0x86; 0xF1; 0x0A; 0x0F; 0x39; 0x45; 0x76; 0x8F; 0x70; 0x8F; 0x5D;
    0xCD; 0x0C; 0xE3; 0x97; 0x4F; 0x9E; 0xA0; 0xC2; 0x79; 0x61; 0xB1; 0x43; 0x04;
    0x28; 0xDE; 0x8F; 0xEF; 0xAB; 0xD4; 0xF2; 0x16; 0x58; 0xC2; 0xD0; 0x2D; 0x60;
    0x03; 0x73; 0x60; 0xCE; 0xF1; 0xB9; 0x93; 0x9A; 0xE3; 0x3B; 0xE9; 0x06; 0x71;
    0x40; 0x94; 0xA1; 0xCC; 0x4C; 0x0D; 0x3E; 0xDA; 0xC2; 0x42; 0x6D; 0xFD; 0xC3;
    0x5A; 0xF1; 0x8E; 0x79; 0xEA; 0x94; 0xFE; 0xC4; 0xE0; 0x14; 0x75; 0x58; 0x09;
    0x05; 0x31; 0x3F; 0xF6; 0xE2; 0x24; 0x82; 0xF9; 0xB0; 0xEB; 0x3F; 0x30; 0xFB;
    0xF0; 0xD9; 0xDF; 0x59; 0x54; 0xE3; 0xBB; 0x44; 0x09; 0x5A; 0x55; 0x9F; 0x39;
    0xEF; 0x05; 0x4E; 0xD3; 0x45; 0x2E; 0x17; 0xAA; 0x2F; 0xC8; 0x77; 0xC6; 0x83;
    0x2C; 0xDE; 0x17; 0xDC; 0x56; 0xF5; 0x30; 0x6F; 0x12; 0x5F; 0x83; 0x93; 0x07;
    0xD2; 0xF0; 0x1D; 0x70; 0x6E; 0xFA; 0xCD; 0x69; 0x1B; 0xD1; 0x31; 0xFF; 0x89;
    0xF5; 0xEC; 0x89; 0xD7; 0x50; 0x2C; 0xB5; 0xC7; 0xDF; 0xC1; 0xD1; 0x55; 0x30;
    0xC3; 0x2E; 0x7D; 0xF5; 0x6E; 0xDD; 0xFE; 0x34; 0x1D; 0x26; 0x4C; 0x82; 0x91;
    0x75; 0x95; 0x7F; 0x72; 0x9F; 0x41; 0x75; 0xB4; 0x4A; 0xF5; 0x4D; 0xA2; 0x0D;
    0x60; 0xBD; 0xAD; 0xDE; 0x11; 0xCE; 0x0C; 0x0A; 0x97; 0x07; 0x13; 0xB9; 0xE1;
    0x98; 0x86; 0x43; 0x2A; 0x94; 0x71; 0xA1; 0x88; 0xC5; 0x8C; 0xA5; 0xFB; 0x45;
    0x5B; 0x1E; 0x82; 0x1B; 0x57; 0xD9; 0x00; 0xA3; 0x4B; 0x99; 0x02; 0x03; 0x01;
    0x00; 0x01; 0xA3; 0x81; 0xE5; 0x30; 0x81; 0xE2; 0x30; 0x0C; 0x06; 0x03; 0x55;
    0x1D; 0x13; 0x01; 0x01; 0xFF; 0x04; 0x02; 0x30; 0x00; 0x30; 0x0E; 0x06; 0x03;
    0x55; 0x1D; 0x0F; 0x01; 0x01; 0xFF; 0x04; 0x04; 0x03; 0x02; 0x03; 0xA8; 0x30;
    0x34; 0x06; 0x03; 0x55; 0x1D; 0x25; 0x04; 0x2D; 0x30; 0x2B; 0x06; 0x08; 0x2B;
    0x06; 0x01; 0x05; 0x05; 0x07; 0x03; 0x02; 0x06; 0x08; 0x2B; 0x06; 0x01; 0x05;
    0x05; 0x07; 0x03; 0x01; 0x06; 0x09; 0x60; 0x86; 0x48; 0x01; 0x86; 0xF8; 0x42;
    0x04; 0x01; 0x06; 0x0A; 0x2B; 0x06; 0x01; 0x04; 0x01; 0x82; 0x37; 0x0A; 0x03;
    0x03; 0x30; 0x33; 0x06; 0x08; 0x2B; 0x06; 0x01; 0x05; 0x05; 0x07; 0x01; 0x01;
    0x04; 0x27; 0x30; 0x25; 0x30; 0x23; 0x06; 0x08; 0x2B; 0x06; 0x01; 0x05; 0x05;
    0x07; 0x30; 0x01; 0x86; 0x17; 0x68; 0x74; 0x74; 0x70; 0x3A; 0x2F; 0x2F; 0x6F;
    0x63; 0x73; 0x70; 0x2E; 0x63; 0x61; 0x63; 0x65; 0x72; 0x74; 0x2E; 0x6F; 0x72;
    0x67; 0x2F; 0x30; 0x38; 0x06; 0x03; 0x55; 0x1D; 0x1F; 0x04; 0x31; 0x30; 0x2F;
    0x30; 0x2D; 0xA0; 0x2B; 0xA0; 0x29; 0x86; 0x27; 0x68; 0x74; 0x74; 0x70; 0x3A;
    0x2F; 0x2F; 0x63; 0x72; 0x6C; 0x2E; 0x63; 0x61; 0x63; 0x65; 0x72; 0x74; 0x2E;
    0x6F; 0x72; 0x67; 0x2F; 0x63; 0x6C; 0x61; 0x73; 0x73; 0x33; 0x2D; 0x72; 0x65;
    0x76; 0x6F; 0x6B; 0x65; 0x2E; 0x63; 0x72; 0x6C; 0x30; 0x1D; 0x06; 0x03; 0x55;
    0x1D; 0x11; 0x04; 0x16; 0x30; 0x14; 0x82; 0x0A; 0x77; 0x77; 0x77; 0x2E; 0x63;
    0x63; 0x63; 0x2E; 0x64; 0x65; 0x82; 0x06; 0x63; 0x63; 0x63; 0x2E; 0x64; 0x65;
    0x30; 0x0D; 0x06; 0x09; 0x2A; 0x86; 0x48; 0x86; 0xF7; 0x0D; 0x01; 0x01; 0x05;
    0x05; 0x00; 0x03; 0x82; 0x02; 0x01; 0x00; 0x85; 0xE6; 0x70; 0x0B; 0x89; 0xE3;
    0x79; 0x17; 0x89; 0x95; 0x56; 0x18; 0x7B; 0xE4; 0x87; 0xBE; 0xD8; 0xE5; 0xCE;
    0x56; 0x3E; 0xAA; 0xF5; 0x27; 0xC0; 0x1E; 0x88; 0x08; 0xCF; 0x3D; 0xBD; 0x8A;
    0x24; 0xB8; 0xA7; 0xA8; 0x3D; 0x07; 0x5A; 0x46; 0x0E; 0x4E; 0x97; 0xDF; 0x44;
    0x26; 0x1F; 0x3A; 0x9C; 0x39; 0x86; 0xD5; 0x90; 0x3B; 0xDA; 0x26; 0x5A; 0x31;
    0xE1; 0x52; 0xB7; 0xFE; 0xF5; 0xCB; 0x95; 0x16; 0x05; 0x77; 0x04; 0x17; 0xD8;
    0xC5; 0x3D; 0x6B; 0x23; 0x85; 0x92; 0xBC; 0x16; 0x65; 0x23; 0xEA; 0x43; 0xC4;
    0x26; 0x89; 0xBF; 0xC0; 0x2E; 0x36; 0xE6; 0x63; 0x20; 0x99; 0x9D; 0x28; 0x07;
    0x13; 0x11; 0x7E; 0x72; 0x09; 0xF0; 0x36; 0x68; 0xC2; 0xD8; 0x4F; 0x61; 0x0B;
    0x0C; 0x1E; 0x0D; 0x53; 0x28; 0x1F; 0xA0; 0x3B; 0xBE; 0x46; 0xB5; 0xC3; 0x78;
    0xE3; 0xA4; 0xF7; 0xEC; 0xF4; 0x6B; 0x4E; 0x24; 0x14; 0xBE; 0x36; 0x6F; 0x71;
    0x58; 0x81; 0xB3; 0x7F; 0x9A; 0x0E; 0x92; 0x62; 0xE4; 0x8D; 0xD8; 0xFC; 0x4B;
    0x18; 0xBB; 0xFB; 0x71; 0x04; 0x18; 0xF9; 0x56; 0x4F; 0xFA; 0x69; 0x24; 0x19;
    0xAB; 0x9D; 0x2A; 0x02; 0x9C; 0x58; 0x95; 0xA4; 0x8F; 0x46; 0xAD; 0x71; 0x20;
    0x3C; 0xDF; 0xBF; 0x47; 0x73; 0x93; 0x08; 0xB1; 0xB6; 0x33; 0x6F; 0xE5; 0x79;
    0x4B; 0xF1; 0xF5; 0xBD; 0xEC; 0xC1; 0x41; 0xDD; 0xC2; 0x2E; 0x90; 0x52; 0xAF;
    0x87; 0x42; 0x7D; 0xBE; 0xBB; 0x2E; 0x3B; 0x16; 0x37; 0x2D; 0x77; 0x1F; 0x4A;
    0xCD; 0xEE; 0xC9; 0x93; 0xD1; 0xE7; 0x08; 0x14; 0x37; 0xAE; 0x67; 0xF9; 0xD3;
    0xF8; 0xEB; 0xFA; 0xB9; 0x6D; 0x15; 0x57; 0x13; 0x37; 0x32; 0x3E; 0x16; 0xBE;
    0x87; 0x9C; 0x65; 0xB3; 0x42; 0x78; 0x31; 0x4E; 0x75; 0xE5; 0x42; 0x22; 0xCC;
    0x08; 0x9B; 0xDB; 0xB3; 0xFE; 0x3D; 0xC7; 0xEF; 0x79; 0x3C; 0x7E; 0x99; 0x4D;
    0xAC; 0xB5; 0x87; 0x12; 0xCC; 0x97; 0x50; 0x4D; 0x6F; 0xC2; 0x74; 0x07; 0x58;
    0x3F; 0x18; 0x53; 0xF9; 0xBD; 0x63; 0x5C; 0x2D; 0x79; 0x2F; 0xA6; 0x3F; 0xC0;
    0x0A; 0x20; 0xE4; 0x08; 0x3A; 0x57; 0x10; 0x6B; 0x3E; 0xD9; 0x0D; 0x39; 0xA4;
    0xA9; 0xD4; 0xE3; 0x68; 0x0F; 0xAB; 0x5B; 0xC0; 0x91; 0x7A; 0xFC; 0x11; 0xBC;
    0x85; 0x11; 0x4D; 0x18; 0x9D; 0x89; 0x3A; 0x82; 0x18; 0x4F; 0x58; 0x32; 0xC9;
    0x72; 0xAF; 0x0D; 0x67; 0x91; 0x1C; 0x6C; 0x59; 0x17; 0xF7; 0x7E; 0x1C; 0x54;
    0xA3; 0xFE; 0x7C; 0xB8; 0xD1; 0xB6; 0x75; 0xE9; 0xD3; 0x27; 0x71; 0x1F; 0x9D;
    0x21; 0xEB; 0x32; 0x16; 0x52; 0xEA; 0x11; 0x39; 0x75; 0x25; 0xE7; 0x4F; 0xA3;
    0x3B; 0x6C; 0xB2; 0x44; 0x80; 0xF1; 0x80; 0xA0; 0xAE; 0x3A; 0x7E; 0x98; 0x97;
    0xD7; 0x3B; 0x98; 0x34; 0xBD; 0xA9; 0x8D; 0x4C; 0xDC; 0xF2; 0x26; 0xBC; 0x77;
    0x2F; 0x94; 0xC9; 0x60; 0x3D; 0xB7; 0x8A; 0xED; 0x0E; 0xB2; 0x3B; 0x4C; 0xF0;
    0xD8; 0x0A; 0x9B; 0x35; 0x95; 0x3B; 0x09; 0xE9; 0xB9; 0x23; 0x5F; 0x42; 0xAB;
    0xB4; 0xEE; 0x46; 0xE3; 0x54; 0x00; 0x40; 0x5A; 0x40; 0x3B; 0x4B; 0xED; 0xF6;
    0x4C; 0x0A; 0x88; 0x44; 0x00; 0xE8; 0x3C; 0x31; 0x4E; 0xAB; 0xA4; 0xF0; 0x31;
    0x1D; 0xAE; 0x70; 0xB2; 0x5E; 0x33; 0xD0; 0x47; 0x56; 0x61; 0xB8; 0xAC; 0xEE;
    0x57; 0x42; 0x5F; 0x8D; 0x39; 0x85; 0x8F; 0xA9; 0xBA; 0xFB; 0x54; 0x43; 0xFA;
    0x03; 0x0E; 0x30; 0x3B; 0xEE; 0x08; 0x43; 0xBE; 0x66; 0xE2; 0xF4; 0x69; 0x57;
    0x68; 0xD5; 0xA7; 0xF5; 0x11; 0x4D; 0xE8; 0x3C; 0x8C; 0x7E; 0x0B; 0x54; 0x3B;
    0xD9; 0x05; 0xB0; 0x92; 0xEE; 0xC7; 0x22; 0x96; 0x85; 0xBF; 0x4F; 0xFE ] ;

  [ 0x30; 0x82; 0x04; 0x76; 0x30; 0x82; 0x03; 0x5e; 0xa0; 0x03; 0x02; 0x01; 0x02;
    0x02; 0x08; 0x43; 0xb5; 0xee; 0xdc; 0xcc; 0x27; 0x93; 0xee; 0x30; 0x0d; 0x06;
    0x09; 0x2a; 0x86; 0x48; 0x86; 0xf7; 0x0d; 0x01; 0x01; 0x05; 0x05; 0x00; 0x30;
    0x49; 0x31; 0x0b; 0x30; 0x09; 0x06; 0x03; 0x55; 0x04; 0x06; 0x13; 0x02; 0x55;
    0x53; 0x31; 0x13; 0x30; 0x11; 0x06; 0x03; 0x55; 0x04; 0x0a; 0x13; 0x0a; 0x47;
    0x6f; 0x6f; 0x67; 0x6c; 0x65; 0x20; 0x49; 0x6e; 0x63; 0x31; 0x25; 0x30; 0x23;
    0x06; 0x03; 0x55; 0x04; 0x03; 0x13; 0x1c; 0x47; 0x6f; 0x6f; 0x67; 0x6c; 0x65;
    0x20; 0x49; 0x6e; 0x74; 0x65; 0x72; 0x6e; 0x65; 0x74; 0x20; 0x41; 0x75; 0x74;
    0x68; 0x6f; 0x72; 0x69; 0x74; 0x79; 0x20; 0x47; 0x32; 0x30; 0x1e; 0x17; 0x0d;
    0x31; 0x34; 0x30; 0x31; 0x32; 0x39; 0x31; 0x34; 0x30; 0x35; 0x33; 0x37; 0x5a;
    0x17; 0x0d; 0x31; 0x34; 0x30; 0x35; 0x32; 0x39; 0x30; 0x30; 0x30; 0x30; 0x30;
    0x30; 0x5a; 0x30; 0x68; 0x31; 0x0b; 0x30; 0x09; 0x06; 0x03; 0x55; 0x04; 0x06;
    0x13; 0x02; 0x55; 0x53; 0x31; 0x13; 0x30; 0x11; 0x06; 0x03; 0x55; 0x04; 0x08;
    0x0c; 0x0a; 0x43; 0x61; 0x6c; 0x69; 0x66; 0x6f; 0x72; 0x6e; 0x69; 0x61; 0x31;
    0x16; 0x30; 0x14; 0x06; 0x03; 0x55; 0x04; 0x07; 0x0c; 0x0d; 0x4d; 0x6f; 0x75;
    0x6e; 0x74; 0x61; 0x69; 0x6e; 0x20; 0x56; 0x69; 0x65; 0x77; 0x31; 0x13; 0x30;
    0x11; 0x06; 0x03; 0x55; 0x04; 0x0a; 0x0c; 0x0a; 0x47; 0x6f; 0x6f; 0x67; 0x6c;
    0x65; 0x20; 0x49; 0x6e; 0x63; 0x31; 0x17; 0x30; 0x15; 0x06; 0x03; 0x55; 0x04;
    0x03; 0x0c; 0x0e; 0x77; 0x77; 0x77; 0x2e; 0x67; 0x6f; 0x6f; 0x67; 0x6c; 0x65;
    0x2e; 0x63; 0x6f; 0x6d; 0x30; 0x82; 0x01; 0x22; 0x30; 0x0d; 0x06; 0x09; 0x2a;
    0x86; 0x48; 0x86; 0xf7; 0x0d; 0x01; 0x01; 0x01; 0x05; 0x00; 0x03; 0x82; 0x01;
    0x0f; 0x00; 0x30; 0x82; 0x01; 0x0a; 0x02; 0x82; 0x01; 0x01; 0x00; 0xa4; 0x78;
    0x79; 0xa6; 0x79; 0x86; 0x3b; 0xb8; 0xc3; 0x11; 0xc4; 0xa8; 0x35; 0xe0; 0xd3;
    0xf1; 0xf3; 0x31; 0x6d; 0x0f; 0xf5; 0x66; 0x50; 0x8d; 0x9b; 0xe0; 0x57; 0x50;
    0x62; 0x00; 0xfc; 0x02; 0xe4; 0x62; 0x7c; 0x0f; 0x9f; 0xaa; 0xfc; 0x62; 0x70;
    0x49; 0x22; 0xed; 0x37; 0x75; 0x4a; 0xb6; 0x78; 0xce; 0x57; 0x67; 0x02; 0x36;
    0xc0; 0x4b; 0xe7; 0xc2; 0xd1; 0xe4; 0x23; 0x8b; 0xc7; 0xe8; 0x25; 0x3a; 0x2c;
    0xae; 0x45; 0xe0; 0x42; 0x0b; 0xf9; 0x76; 0xcd; 0x3e; 0xf2; 0x55; 0x37; 0x76;
    0x8a; 0x15; 0x5e; 0x8a; 0x9e; 0x99; 0xe2; 0x4a; 0x52; 0x28; 0x73; 0x23; 0xf8;
    0x7e; 0xed; 0xc7; 0xf5; 0xdb; 0xce; 0xff; 0xec; 0x46; 0xcc; 0x23; 0x94; 0x5a;
    0x0c; 0x15; 0x0f; 0x4c; 0x79; 0x99; 0x1d; 0xe0; 0xed; 0x93; 0x7f; 0x17; 0x51;
    0x8b; 0x01; 0xad; 0x2f; 0x77; 0x9c; 0x80; 0xaa; 0xe1; 0x50; 0xd4; 0x03; 0x1c;
    0xb6; 0x04; 0xab; 0x06; 0x49; 0x2d; 0xa5; 0xf7; 0x04; 0x6f; 0x97; 0x87; 0xe1;
    0x74; 0x30; 0xe6; 0x82; 0xe4; 0x39; 0x71; 0x10; 0xca; 0x9f; 0xfa; 0x6a; 0x75;
    0x81; 0x2a; 0x02; 0xac; 0x45; 0x54; 0x48; 0xda; 0x9b; 0x08; 0xdc; 0x51; 0x64;
    0x81; 0xb1; 0x69; 0x6a; 0x4a; 0x7d; 0xfb; 0x7c; 0x8f; 0x6c; 0xfc; 0xc6; 0x43;
    0x0b; 0x37; 0xcc; 0xc3; 0x3e; 0x80; 0x85; 0xe1; 0x4c; 0xad; 0x13; 0x4b; 0xd2;
    0x82; 0x76; 0x63; 0x77; 0x15; 0x74; 0x1c; 0x62; 0x0d; 0x57; 0x6a; 0x8c; 0x64;
    0xbe; 0x00; 0x6e; 0x6a; 0x21; 0x4c; 0xff; 0x02; 0xcb; 0xc7; 0x34; 0xbd; 0xc9;
    0x12; 0xc6; 0xb9; 0xe4; 0xe4; 0xab; 0x30; 0x5b; 0x9b; 0x08; 0xf0; 0xb3; 0x60;
    0x33; 0x00; 0x54; 0xb2; 0xb3; 0x8a; 0xa6; 0x57; 0xe4; 0x6d; 0xb9; 0x73; 0x47;
    0xbf; 0xaa; 0x1d; 0x1b; 0x48; 0xae; 0x3f; 0x02; 0x03; 0x01; 0x00; 0x01; 0xa3;
    0x82; 0x01; 0x41; 0x30; 0x82; 0x01; 0x3d; 0x30; 0x1d; 0x06; 0x03; 0x55; 0x1d;
    0x25; 0x04; 0x16; 0x30; 0x14; 0x06; 0x08; 0x2b; 0x06; 0x01; 0x05; 0x05; 0x07;
    0x03; 0x01; 0x06; 0x08; 0x2b; 0x06; 0x01; 0x05; 0x05; 0x07; 0x03; 0x02; 0x30;
    0x19; 0x06; 0x03; 0x55; 0x1d; 0x11; 0x04; 0x12; 0x30; 0x10; 0x82; 0x0e; 0x77;
    0x77; 0x77; 0x2e; 0x67; 0x6f; 0x6f; 0x67; 0x6c; 0x65; 0x2e; 0x63; 0x6f; 0x6d;
    0x30; 0x68; 0x06; 0x08; 0x2b; 0x06; 0x01; 0x05; 0x05; 0x07; 0x01; 0x01; 0x04;
    0x5c; 0x30; 0x5a; 0x30; 0x2b; 0x06; 0x08; 0x2b; 0x06; 0x01; 0x05; 0x05; 0x07;
    0x30; 0x02; 0x86; 0x1f; 0x68; 0x74; 0x74; 0x70; 0x3a; 0x2f; 0x2f; 0x70; 0x6b;
    0x69; 0x2e; 0x67; 0x6f; 0x6f; 0x67; 0x6c; 0x65; 0x2e; 0x63; 0x6f; 0x6d; 0x2f;
    0x47; 0x49; 0x41; 0x47; 0x32; 0x2e; 0x63; 0x72; 0x74; 0x30; 0x2b; 0x06; 0x08;
    0x2b; 0x06; 0x01; 0x05; 0x05; 0x07; 0x30; 0x01; 0x86; 0x1f; 0x68; 0x74; 0x74;
    0x70; 0x3a; 0x2f; 0x2f; 0x63; 0x6c; 0x69; 0x65; 0x6e; 0x74; 0x73; 0x31; 0x2e;
    0x67; 0x6f; 0x6f; 0x67; 0x6c; 0x65; 0x2e; 0x63; 0x6f; 0x6d; 0x2f; 0x6f; 0x63;
    0x73; 0x70; 0x30; 0x1d; 0x06; 0x03; 0x55; 0x1d; 0x0e; 0x04; 0x16; 0x04; 0x14;
    0x75; 0x20; 0xea; 0xd1; 0xf9; 0xb9; 0xb7; 0x34; 0xd5; 0xe9; 0xe4; 0x35; 0x8a;
    0xae; 0xe8; 0x64; 0xc6; 0x73; 0x2b; 0xa4; 0x30; 0x0c; 0x06; 0x03; 0x55; 0x1d;
    0x13; 0x01; 0x01; 0xff; 0x04; 0x02; 0x30; 0x00; 0x30; 0x1f; 0x06; 0x03; 0x55;
    0x1d; 0x23; 0x04; 0x18; 0x30; 0x16; 0x80; 0x14; 0x4a; 0xdd; 0x06; 0x16; 0x1b;
    0xbc; 0xf6; 0x68; 0xb5; 0x76; 0xf5; 0x81; 0xb6; 0xbb; 0x62; 0x1a; 0xba; 0x5a;
    0x81; 0x2f; 0x30; 0x17; 0x06; 0x03; 0x55; 0x1d; 0x20; 0x04; 0x10; 0x30; 0x0e;
    0x30; 0x0c; 0x06; 0x0a; 0x2b; 0x06; 0x01; 0x04; 0x01; 0xd6; 0x79; 0x02; 0x05;
    0x01; 0x30; 0x30; 0x06; 0x03; 0x55; 0x1d; 0x1f; 0x04; 0x29; 0x30; 0x27; 0x30;
    0x25; 0xa0; 0x23; 0xa0; 0x21; 0x86; 0x1f; 0x68; 0x74; 0x74; 0x70; 0x3a; 0x2f;
    0x2f; 0x70; 0x6b; 0x69; 0x2e; 0x67; 0x6f; 0x6f; 0x67; 0x6c; 0x65; 0x2e; 0x63;
    0x6f; 0x6d; 0x2f; 0x47; 0x49; 0x41; 0x47; 0x32; 0x2e; 0x63; 0x72; 0x6c; 0x30;
    0x0d; 0x06; 0x09; 0x2a; 0x86; 0x48; 0x86; 0xf7; 0x0d; 0x01; 0x01; 0x05; 0x05;
    0x00; 0x03; 0x82; 0x01; 0x01; 0x00; 0x3a; 0x8f; 0xda; 0x0f; 0x28; 0x4e; 0x64;
    0xfc; 0x55; 0xf9; 0xb1; 0xb2; 0xd8; 0xe2; 0x9e; 0xf1; 0xb2; 0x79; 0x6d; 0x9d;
    0xd1; 0xc3; 0x37; 0x5a; 0x32; 0xce; 0x66; 0xfc; 0xf9; 0xc9; 0xa4; 0x7b; 0xa5;
    0xbf; 0x78; 0x51; 0xec; 0x63; 0x48; 0x3e; 0xcd; 0x47; 0x94; 0x05; 0x6d; 0xf3;
    0x6f; 0x41; 0x0c; 0x06; 0x73; 0x57; 0x58; 0xd4; 0xc2; 0x07; 0x56; 0x95; 0x21;
    0xc4; 0x46; 0x7b; 0xc1; 0x94; 0x0c; 0x30; 0x27; 0x03; 0x34; 0x97; 0x31; 0x00;
    0x5e; 0x06; 0x2b; 0x0d; 0x6f; 0xaf; 0x64; 0x9f; 0x6b; 0xa7; 0xb5; 0x2e; 0xd1;
    0x6e; 0x52; 0xfc; 0xdf; 0xef; 0x07; 0xef; 0xce; 0xd1; 0xb0; 0xb7; 0x97; 0xb9;
    0xc6; 0xa1; 0xaf; 0x79; 0x02; 0xa1; 0xce; 0xb5; 0xa1; 0x37; 0xa6; 0x23; 0x41;
    0xc4; 0x23; 0x8d; 0xce; 0x0e; 0xd5; 0x48; 0xb8; 0x51; 0x03; 0x34; 0x90; 0xc4;
    0xd7; 0x0a; 0xac; 0x1e; 0x47; 0x59; 0x79; 0xc9; 0xcd; 0x4b; 0x6f; 0x48; 0x67;
    0x24; 0xa9; 0x2b; 0x6b; 0x24; 0xaf; 0x7a; 0xc7; 0xee; 0xa5; 0x24; 0x6c; 0xfd;
    0x65; 0x93; 0x36; 0xc5; 0xbe; 0xc9; 0xc5; 0x53; 0x2a; 0x77; 0x00; 0x94; 0xb8;
    0x89; 0xbf; 0x7e; 0xe3; 0x13; 0xeb; 0xeb; 0x91; 0x90; 0x7d; 0x48; 0xbf; 0xf2;
    0xf8; 0x28; 0x49; 0x5b; 0xce; 0xcb; 0x96; 0x37; 0xad; 0x3f; 0xd4; 0xdc; 0x2b;
    0x48; 0xf6; 0xd3; 0xe8; 0x0d; 0x26; 0x53; 0x60; 0x64; 0xe5; 0xeb; 0x82; 0xc3;
    0xc4; 0x96; 0xbc; 0x74; 0x41; 0x98; 0x99; 0x32; 0x87; 0x82; 0x3c; 0x89; 0x1e;
    0x66; 0xca; 0xcd; 0xeb; 0x35; 0xdc; 0xdf; 0xc1; 0x37; 0x5f; 0x17; 0x52; 0x5b;
    0xd3; 0x9e; 0x31; 0x1a; 0x89; 0xf4; 0x17; 0xbc; 0x98; 0xfd; 0xca; 0x9a; 0x9c;
    0x30; 0x75; 0x05; 0x3e; 0x39; 0x2a; 0xc0; 0x8d; 0x47; 0x4b; 0x26; 0xf5; 0x89;
    0x1b; 0x61; ] ;

  [ 0x30; 0x82; 0x02; 0x63; 0x30; 0x82; 0x01; 0xcc; 0x02; 0x09; 0x00; 0xcb; 0x6c;
    0x4e; 0x84; 0x4b; 0x58; 0xa1; 0xd4; 0x30; 0x0d; 0x06; 0x09; 0x2a; 0x86; 0x48;
    0x86; 0xf7; 0x0d; 0x01; 0x01; 0x05; 0x05; 0x00; 0x30; 0x76; 0x31; 0x0b; 0x30;
    0x09; 0x06; 0x03; 0x55; 0x04; 0x06; 0x13; 0x02; 0x41; 0x55; 0x31; 0x13; 0x30;
    0x11; 0x06; 0x03; 0x55; 0x04; 0x08; 0x0c; 0x0a; 0x53; 0x6f; 0x6d; 0x65; 0x2d;
    0x53; 0x74; 0x61; 0x74; 0x65; 0x31; 0x21; 0x30; 0x1f; 0x06; 0x03; 0x55; 0x04;
    0x0a; 0x0c; 0x18; 0x49; 0x6e; 0x74; 0x65; 0x72; 0x6e; 0x65; 0x74; 0x20; 0x57;
    0x69; 0x64; 0x67; 0x69; 0x74; 0x73; 0x20; 0x50; 0x74; 0x79; 0x20; 0x4c; 0x74;
    0x64; 0x31; 0x15; 0x30; 0x13; 0x06; 0x03; 0x55; 0x04; 0x03; 0x0c; 0x0c; 0x59;
    0x4f; 0x55; 0x52; 0x20; 0x4e; 0x41; 0x4d; 0x45; 0x21; 0x21; 0x21; 0x31; 0x18;
    0x30; 0x16; 0x06; 0x09; 0x2a; 0x86; 0x48; 0x86; 0xf7; 0x0d; 0x01; 0x09; 0x01;
    0x16; 0x09; 0x6d; 0x65; 0x40; 0x62; 0x61; 0x72; 0x2e; 0x64; 0x65; 0x30; 0x1e;
    0x17; 0x0d; 0x31; 0x34; 0x30; 0x32; 0x31; 0x37; 0x32; 0x32; 0x30; 0x38; 0x34;
    0x35; 0x5a; 0x17; 0x0d; 0x31; 0x35; 0x30; 0x32; 0x31; 0x37; 0x32; 0x32; 0x30;
    0x38; 0x34; 0x35; 0x5a; 0x30; 0x76; 0x31; 0x0b; 0x30; 0x09; 0x06; 0x03; 0x55;
    0x04; 0x06; 0x13; 0x02; 0x41; 0x55; 0x31; 0x13; 0x30; 0x11; 0x06; 0x03; 0x55;
    0x04; 0x08; 0x0c; 0x0a; 0x53; 0x6f; 0x6d; 0x65; 0x2d; 0x53; 0x74; 0x61; 0x74;
    0x65; 0x31; 0x21; 0x30; 0x1f; 0x06; 0x03; 0x55; 0x04; 0x0a; 0x0c; 0x18; 0x49;
    0x6e; 0x74; 0x65; 0x72; 0x6e; 0x65; 0x74; 0x20; 0x57; 0x69; 0x64; 0x67; 0x69;
    0x74; 0x73; 0x20; 0x50; 0x74; 0x79; 0x20; 0x4c; 0x74; 0x64; 0x31; 0x15; 0x30;
    0x13; 0x06; 0x03; 0x55; 0x04; 0x03; 0x0c; 0x0c; 0x59; 0x4f; 0x55; 0x52; 0x20;
    0x4e; 0x41; 0x4d; 0x45; 0x21; 0x21; 0x21; 0x31; 0x18; 0x30; 0x16; 0x06; 0x09;
    0x2a; 0x86; 0x48; 0x86; 0xf7; 0x0d; 0x01; 0x09; 0x01; 0x16; 0x09; 0x6d; 0x65;
    0x40; 0x62; 0x61; 0x72; 0x2e; 0x64; 0x65; 0x30; 0x81; 0x9f; 0x30; 0x0d; 0x06;
    0x09; 0x2a; 0x86; 0x48; 0x86; 0xf7; 0x0d; 0x01; 0x01; 0x01; 0x05; 0x00; 0x03;
    0x81; 0x8d; 0x00; 0x30; 0x81; 0x89; 0x02; 0x81; 0x81; 0x00; 0xb6; 0x40; 0x48;
    0xde; 0xe6; 0xbc; 0x21; 0x94; 0x3d; 0xa2; 0xab; 0x5e; 0xb6; 0xf8; 0xd8; 0x37;
    0x00; 0x7f; 0x41; 0x7c; 0x0f; 0xe3; 0x34; 0x92; 0xc3; 0xaa; 0x2f; 0x55; 0x3e;
    0x4d; 0x5e; 0x31; 0x43; 0x46; 0x89; 0xc2; 0x6f; 0x2b; 0xe6; 0x8e; 0x00; 0xd2;
    0x88; 0xb0; 0xe3; 0xab; 0xf6; 0xfe; 0x11; 0x88; 0x45; 0xd9; 0x49; 0x89; 0x85;
    0x12; 0xf1; 0x92; 0xcb; 0xe4; 0x9f; 0xd5; 0xb0; 0x83; 0x1f; 0x01; 0xcb; 0x2d;
    0x27; 0x4d; 0xb3; 0xa6; 0x38; 0xf5; 0xbe; 0xfb; 0x3c; 0xe8; 0x1a; 0xb6; 0xb5;
    0x59; 0x39; 0x34; 0x44; 0x04; 0x4f; 0xed; 0xd6; 0xca; 0x15; 0x4f; 0x76; 0xbf;
    0xbd; 0x52; 0x56; 0x08; 0xbb; 0x55; 0x0a; 0x39; 0xbb; 0xd2; 0xed; 0x12; 0xe6;
    0xd7; 0x1f; 0x9f; 0x84; 0xba; 0x21; 0xaa; 0x5e; 0x21; 0x80; 0x15; 0x02; 0x67;
    0x1a; 0xab; 0x04; 0x9a; 0xf8; 0x64; 0x0d; 0xa1; 0x02; 0x03; 0x01; 0x00; 0x01;
    0x30; 0x0d; 0x06; 0x09; 0x2a; 0x86; 0x48; 0x86; 0xf7; 0x0d; 0x01; 0x01; 0x05;
    0x05; 0x00; 0x03; 0x81; 0x81; 0x00; 0x8a; 0x38; 0x66; 0x9a; 0x48; 0x96; 0x9d;
    0xc9; 0x47; 0x29; 0x6d; 0x44; 0x2d; 0x7f; 0x03; 0x20; 0x82; 0xd2; 0xdb; 0x21;
    0xe5; 0x37; 0x4c; 0xdd; 0x6e; 0xf6; 0xe7; 0xcc; 0x1d; 0xa0; 0xfd; 0xe5; 0x11;
    0xed; 0x3c; 0x52; 0x52; 0xf0; 0xa6; 0x73; 0xdc; 0x68; 0x9f; 0xdc; 0x5f; 0xca;
    0xcc; 0x1b; 0x85; 0xdf; 0xe2; 0x2b; 0x7b; 0xef; 0x2a; 0xdb; 0x56; 0xb5; 0x37;
    0x32; 0xe9; 0x81; 0x10; 0x63; 0x79; 0x4d; 0x6e; 0x23; 0x9f; 0x8f; 0xa2; 0x67;
    0x21; 0x5b; 0xa7; 0xa4; 0xd3; 0xdc; 0xe5; 0x05; 0xe7; 0x99; 0xec; 0x5c; 0x38;
    0xcd; 0x1c; 0x16; 0xee; 0x75; 0xe0; 0xd5; 0xa4; 0x6b; 0x8f; 0x4c; 0x8e; 0x82;
    0x65; 0x05; 0x61; 0x53; 0x9a; 0x84; 0x30; 0x5d; 0xf1; 0x9a; 0x5a; 0x24; 0x1b;
    0xe5; 0x55; 0xf8; 0x70; 0x83; 0x4e; 0x09; 0x4d; 0x41; 0xcf; 0x9f; 0x74; 0xb3;
    0x34; 0x2e; 0x83; 0x45 ] ;
]
